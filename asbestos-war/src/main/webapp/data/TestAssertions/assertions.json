{
  "id": "NIST FHIR(r) Toolkit (Asbestos) Assertion References Mapping File",
  "referenceMetadata": {
    "version": "1.0",
    "lastUpdated": "2022-JAN-18",
    "comments": {
      "purpose": "This JSON is general purpose format, it may be suitable for other specifications. All specifications are captured as of the lastUpdated date. This offline list only serves as a quick reference for the Asbestos Toolkit users. Users should be familiar with the actual specification guidelines. With the help of the community, any future changes in the actual specification text will have to reported through a GitHub Pull Request for a review until advancements in automated StructureDefinition-based references can generate this format. Note: There is no JSON schema for this ReferenceMetata, it can be added in future.",
      "assertionReferences-assertionId": "Use ShortCode(_Integer)+, where ShortCode is the prefix before the assertion TestScript file. Ids are sequentially numbered, at least one _Integer suffix is required. New independent assertion Ids can be inserted in between two existing Ids by appending a _Integer, example SC_1, SC_1_1, SC_2."
    }
  },
  "assertionReferences": {
    "BR_1":         [{"fhir": "Bundle", "context": ".entry.fullUrl-type"},
      {"fhir": "resourceUrl-transaction", "verbatimPhraseToFocus": "Note"}],
    "BR_2":         [{"fhir": "Bundle", "context":"bundleConstraint-bdl7"},
      {"fhir": "restApi", "context":"transactionProcessingRules-uniqueResource"}],
    "BR_3":         [{"fhir": "httpTransaction"},
      {"fhir": "Bundle", "context":".entry.request.url"},
      {"fhir": "Bundle", "context":".entry.request.method-cardinality"}
    ],
    "BR_4":         [{"fhir": "Bundle", "context":".entry.request.url", "verbatimPhraseToFocus": "Type"}],
    "CMPMETA_1":   [{"mhdv4": "ITI-65_BundleResources", "context":"Bundle.meta.profile",
      "verbatimPhraseToFocus": "Bundle.meta.profile"}],
    "CMPMETA3_1":   [{"mhdComprehensive": "DocumentReference", "context": ".subject"}],
    "CMPMETA3_2":   [{"mhdComprehensive": "DocumentManifest", "context": "mappingTable"}],
    "CMPMETA4_1":   [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
      {"mhdv4Comprehensive": "SubmissionSetTypeList", "context": ".subject"},
      {"mhdComprehensive": "DocumentReference", "context": ".subject"},
      {"mhdv4Comprehensive": "SubmissionSetTypeList", "context": "CmpMeta_mappingToXds"}],
    "CMPMETA4_2":   [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
      {"mhdv4Comprehensive": "SubmissionSetTypeList", "context": ".extension:designationType"},
      {"mhdv4Comprehensive": "SubmissionSetTypeList", "context": "CmpMeta_mappingToXds"}],
    "CMPMETA_3":   [{"mhdv4": "ITI-65_BundleResources", "context":"Bundle.meta.profile",
      "verbatimPhraseToFocus": "Bundle.meta.profile"}],
    "CMPMETA_4":   [{"mhdComprehensive": "DocumentReference", "context": ".securityLabel"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_1":     [{"mhdComprehensive": "DocumentReference", "context": ".content.format"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_2":     [{"mhdComprehensive": "DocumentReference", "context": ".content.attachment.language"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_3":     [{"mhdComprehensive": "DocumentReference", "context": ".content.attachment.contentType"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_4":     [{"mhdComprehensive": "DocumentReference", "context": ".context.facilityType"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_5":     [{"mhdComprehensive": "DocumentReference", "context": ".context.practiceSetting"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "CMPDR_6":     [{"mhdComprehensive": "DocumentReference", "context": ".context.sourcePatientInfo"},
      {"mhdComprehensive": "DocumentReference", "context": "CmpMeta_mappingToXds"},
      {"xds": "4.3.1 Submission Metadata Attribute Optionality"}],
    "DR_1":         [{"mhd": "DocumentReference", "context": ".content"  }],
    "DR_2":         [{"mhd": "DocumentReference", "context": ".content.attachment.url"}],
    "DR_3":         [{"mhd": "DocumentReference", "context": ".content.attachment.contentType"}],
    "DR_4":         [{"mhd": "DocumentReference", "context": ".content.attachment.data"}],
    "DR_5":         [{"mhd": "ITI-65_BundleResources", "context": "binaryResourceInBundle"}],
    "DR_6":         [{"mhd": "DocumentReference", "context": ".content.attachment.contentType"},
      {"fhir": "Binary", "context": ".contentType"}],
    "DR_7":         [{"mhdv4": "ITI-65_non-unContainedOption", "context": "sourcePatientInfo",
      "verbatimPhraseToFocus": "Otherwise, when sourcePatientInfo is provided, the DocumentReference.context.sourcePatientInfo shall be a reference to a \"contained\" Patient Resource"}],
    "DR_8":         [{"mhdv4": "ITI-65_non-unContainedOption", "context": "MISSINGTEXTInMHD4"}],
    "DR_9":         [{"mhdv4": "ITI-65_non-unContainedOption", "context": "MISSINGTEXTInMHD4"}],
    "DR_10":        [{"mhd": "DocumentReference", "context": ".masterIdentifier"}],
    "DR_11":        [{"mhd": "DocumentReference", "context": ".status"}],
    "DRP2_1":        [{"mhdv3x": "DocumentReference", "context": ".identifier"}],
    "MINMETA4_1":   [{"mhdv4": "ITI-65_BundleResources", "context":"Bundle.meta.profile",
      "verbatimPhraseToFocus": "Bundle.meta.profile"}],
    "MINMETA4_2":   [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
      {"mhdv4": "SubmissionSetTypeList", "context": ".subject"},
      {"mhd": "DocumentReference", "context": ".subject"},
      {"mhd": "DocumentReference", "context": "MinMeta_mappingToXds"}],
    "MINMETA4_3":   [{"mhdv4": "SubmissionSetTypeList", "context": ".subject"},
      {"mhd": "DocumentReference", "context": ".subject"},
      {"mhd": "DocumentReference", "context": "MinMeta_mappingToXds"}],
    "RM4_1":        [{"mhdv4": "ITI-65_RequestMessage", "context": "messageSemantics"}],
    "RM4_1_1":      [{"mhdv4": "ITI-65_RequestMessage", "context": "messageSemantics"}],
    "RM4_1_2":      [{"mhdv4": "ITI-65_RequestMessage", "context": "messageSemantics"},
                     {"fhir": "httpTransaction", "verbatimPhraseToFocus": "transaction"}],
    "RM4_2":        [{"mhdv4": "ITI-65_RequestMessage", "context": "messageSemantics"}],
    "RM4_3":        [{"mhdv4": "ITI-65_RequestMessage", "context": "messageSemantics"}],
    "RM4_4":        [{"mhdv4": "ITI-65_BundleResources", "context":"Bundle.meta.profile",
                      "verbatimPhraseToFocus": "Bundle.meta.profile"}],
    "RM4_5":        [{"mhdv4": "SubmissionSetTypeList", "context": "attributeMap" },
                     {"mhdv4": "SubmissionSetTypeList", "context":"mappingToXds" }],
    "RM4_6":        [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
                     {"mhd": "DocumentReference", "context": "MinMeta_mappingToXds"}],
    "SDR_1":         [{"mhd": "ITI-67_ResponseMessage", "context": "messageSemantics_p3",
                    "verbatimPhraseToFocus": "If the Find Document References message is processed successfully, whether or not any DocumentReference Resources are found, the HTTP status code shall be 200."}],
    "SDR_2":         [{"fhir": "Bundle", "context": ".total"}],
    "SDR_3":         [{"mhd": "ITI-67_ResponseMessage", "context": "messageSemantics_p3"}],
    "SDR_4":         [{"fhir": "Bundle", "context": ".entry.fullUrl"}],
    "SSLIST_1":     [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"}],
    "SSLIST_2":     [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
                      {"mhdv4": "SubmissionSetTypeList", "context": ".extension:sourceId"}],
    "SSLIST_3":     [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
                      {"mhdv4": "SubmissionSetTypeList", "context": ".date"}],
    "SUBJ4_1":      [{"mhdv4": "patientReference"}],
    "SUBJ4_2":      [{"mhdv4": "patientReference", "verbatimPhraseToFocus": "FHIR Patient Resource"}],
    "SUBJ4_3":      [{"mhdv4": "ITI-65_RequestMessage", "context": "elements"},
                      {"xds": "4.2 ebRIM Representation", "context": "associatedPatient"}],
    "TR_1":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p2",
                      "verbatimPhraseToFocus": "To indicate success the overall http 200 response is used"}],
    "TR_2":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p1"}],
    "TR_3":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p1"}],
    "TR_4":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p1",
                      "verbatimPhraseToFocus": "contains one entry for each entry in the request"},
                     {"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p2"}],
    "TR_5":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p2"}],
    "TR_6":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p2"}],
    "TR_7":         [{"fhir": "restApi", "context": "response.lastModified"}],
    "TR_8":         [{"fhir": "restApi", "context": "transactionResponse-operationOutcome",
                      "verbatimPhraseToFocus": "For a failed transaction, the server returns a single OperationOutcome instead of a Bundle"}],
    "TR_9":         [{"mhd": "ITI-65_ResponseMessage", "context": "messageSemantics_p1", "verbatimPhraseToFocus": "contains one entry for each entry in the request"}]
  },

  "references": {
    "mhdv4Comprehensive": {
      "SubmissionSetTypeList": {
        "baseLink": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Comprehensive.SubmissionSet-definitions.html#List",
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Metadata": {
            "text": "Comprehensive"
          }
        },
        "context": {
          ".extension:designationType": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".subject": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          "CmpMeta_mappingToXds": {
            "ComprehensiveSubmissionSet": {
              "text": "Mappings for XDS and MHD Mapping (XDS)",
              "link": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Comprehensive.SubmissionSet-mappings.html#mappings-for-xds-and-mhd-mapping-xds"
            },
            "SpecificationText": [{
              "text": "",
              "comments": "Map of .extension:designationType is missing, should be contentTypeCode."
            }]
          }
        }
      }
    },
    "mhdComprehensive": {
      "DocumentManifest": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv3.x"
          },
          "Metadata": {
            "text": "Comprehensive"
          }
        },
        "context": {
          "mappingTable": {
            "Table" : {
              "text": "4.5.1.2-1: FHIR DocumentManifest mapping to SubmissionSet"
            },
            "SpecificationText": [{
              "text": "<div style=\"display:grid;grid-template-columns: 1fr 1fr 1fr 1fr;\"><div class='bold'>FHIR DocumentManifest Resource Definition</div><div class='bold'>IHE constraint</div><div class='bold'>Document Sharing metadata</div><div class='bold'>Notes</div>\n<div>type</div><div></div><div>contentTypeCode</div><div></div></div>"
            }]
          }
        }
      },
      "DocumentReference": {
        "baseLink": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Comprehensive.DocumentReference-definitions.html#DocumentReference",
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv3.x, MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Metadata": {
            "text": "Comprehensive"
          }
        },
        "context": {
          ".content.attachment.contentType": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".content.attachment.language": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".content.format": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".context.facilityType": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".context.practiceSetting": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".context.sourcePatientInfo": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".subject": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".securityLabel": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..*"
            }]
          },
          "CmpMeta_mappingToXds": {
            "ComprehensiveDocumentReference": {
              "text": "Mappings for XDS and MHD Mapping (XDS)",
              "link": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Comprehensive.DocumentReference-mappings.html#mappings-for-xds-and-mhd-mapping-xds"
            }
          }
        }
      }
    },
    "mhd": {
      "ITI-65_ResponseMessage": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Transaction": {
            "text": "ITI-65 Provide Document Bundle",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2-3-65-provide-document-bundle-iti-65"
          },
          "Volume:Section": {
            "text": "2:3.65.4.2.2 Message Semantics",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2365422-message-semantics"
          }
        },
        "context": {
          "messageSemantics_p1": {
            "SpecificationText": [{
              "text":
              "To enable the Document Source to know the outcome of processing the transaction, and the identities assigned to the resources by the Document Recipient, the Document Recipient shall return a Bundle, with type set to transaction-response, that contains one entry for each entry in the request, in the same order as received, with the Bundle.entry.response.outcome indicating the results of processing the entry warnings such as PartialFolderContentNotProcessed. The Document Recipient shall comply with FHIR http://hl7.org/fhir/R4/bundle.html#transaction-response and http://hl7.org/fhir/R4/http.html#transaction-response."
            }]
          },
          "messageSemantics_p2": {
            "SpecificationText": [{
              "text": "(Para 2.)<br>To indicate success the overall http 200 response is used. The Bundle.entry.response.status shall be 201 to indicate the Resource has been created, the .location element shall be populated, and the .etag element may be populated when the Document Recipient supports FHIR resource versioning."
            }]
          }
        }
      },
      "DocumentReference": {
        "baseLink": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Minimal.DocumentReference-definitions.html#DocumentReference",
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv3.x, MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Metadata": {
            "text": "Minimal or Comprehensive"
          }
        },
        "context": {
          ".content": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1",
              "comments": "<a target='_blank' href='https://github.com/IHE/ITI.MHD/issues/110'>Issue 110.</a>"
            }]
          },
          ".content.attachment.url": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".content.attachment.contentType": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".content.attachment.data": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 0..0"
            }]
          },
          ".masterIdentifier": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".status": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1<br>Type code<br>The codes SHALL be taken from DocumentReferenceStatus The status of the document reference."
            }]
          },
          ".subject": {
            "Element": {},
            "Metadata": {
              "text": "Minimal"
            },
            "SpecificationText": [{
              "text": "Control 0..1",
              "comments": "MustSupport, Required if known. https://profiles.ihe.net/ITI/MHD/index.html#must-support"
            }]
          },
            "MinMeta_mappingToXds": {
              "MinimalDocumentReference": {
                "text": "Mappings for XDS and MHD Mapping (XDS)",
                "link": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Minimal.DocumentReference-mappings.html#mappings-for-xds-and-mhd-mapping-xds"
              },
              "SpecificationText": [{
                "text": "identifier DocumentEntry.entryUUID"
              }]
            }
        }
      },
      "ITI-65_BundleResources": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv3.x, MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Transaction": {
            "text": "ITI-65 Provide Document Bundle",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2-3-65-provide-document-bundle-iti-65"
          },
          "Volume:Section": {
            "text": "2:3.65.4.1.2.1 Bundle Resources",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654121-bundle-resources"
          }
        },
        "context": {
          "binaryResourceInBundle" : {
            "SpecificationText": [{
              "text": "When the DocumentReference.content.attachment.url points at a Binary Resource, the Binary Resource shall be in the Bundle."
            }]
          }
        }
      },
      "ITI-67_ResponseMessage": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv3.x, MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Transaction": {
            "text": "ITI-67 Find Document References",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-67.html"
          },
          "Volume:Section": {
            "text": "2:3.67.4.2 Find Document References Response message",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-67.html#236742-find-document-references-response-message"
          }
        },
        "context": {
          "messageSemantics_p3": {
            "SpecificationText": [
              {
                "text": "If the Find Document References message is processed successfully, whether or not any DocumentReference Resources are found, the HTTP status code shall be 200. The Find Document References Response message shall be a Bundle Resource containing zero or more DocumentReference Resources. If the Document Responder is sending warnings, the Bundle Resource shall also contain an OperationOutcome Resource that contains those warnings."
              }
            ]
          }
        }
      }
   },
    "mhdv3x": {
      "DocumentReference": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHD Rev. 3.x - Trial Implementation"
          },
          "Metadata": {
            "text": "Minimal or Comprehensive"
          }
        },
        "context": {
          ".identifier": {
            "Section": {
              "text": "Table 4.5.1.1-1: FHIR DocumentReference mapping to DocumentEntry"
            },
            "Element": {},
            "SpecificationText": [{
              "text": "When the DocumentReference.identifier carries the entryUUID then the DocumentReference.identifier.use shall be 'official'"
            }]
          }
        }
      }
    },
    "mhdv4": {
      "ITI-65_BundleResources": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Transaction": {
            "text": "ITI-65 Provide Document Bundle",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2-3-65-provide-document-bundle-iti-65"
          },
          "Volume:Section": {
            "text": "2:3.65.4.1.2.1 Bundle Resources",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654121-bundle-resources"
          }
        },
        "context": {
          "Bundle.meta.profile": {
            "SpecificationText": [{
              "text": "The FHIR Bundle.meta.profile shall have the following value depending on the Actor implementation of no options (Minimal Metadata), Comprehensive Metadata Option, or UnContained References Option...",
              "comments": "<span>1:33.2.3 UnContained Reference Option</span><br>https://profiles.ihe.net/ITI/MHD/1332_actor_options.html#13323-uncontained-reference-option<br>The UnContained Reference Option is not compatible with the XDS on FHIR Option. A system may be able to support both options, but only one will be able to be used at a given deployment.<br>UnContained References Option is not yet supported in Toolkit."
            }]
          }
        }
      },
      "ITI-65_RequestMessage": {
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Transaction": {
            "text": "ITI-65 Provide Document Bundle",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2-3-65-provide-document-bundle-iti-65"
          },
          "Volume:Section": {
            "text": "2:3.65.4.1.2 Message Semantics",
            "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2365412-message-semantics"
          }
        },
        "context": {
          "messageSemantics": {
            "SpecificationText": [{
              "hasAssertionOrderBiasAnnotations": true,
              "text": "The Document Source shall initiate [2.1]a FHIR \"transaction\" using a \"create\" action by [1.0]sending an HTTP POST request method [2.0]composed of a FHIR Bundle Resource [2.2]containing: one SubmissionSet type List Resource; [2.3]one or more DocumentReference Resources; [2.4]zero or more Folder type List Resources; and [2.5]zero or more Binary Resources to the Document Recipient. ",
              "comments": "<span>MHD specification issue:</span><br>https://profiles.ihe.net/ITI/MHD/ITI-65.html#2365412-message-semantics<br>(Para 1.) Zero or more Binary Resources does not seem right. If one or more DocumentReference is expected, then according to 2:3.65.4.1.2.1 Bundle Resources, Binary shall be in the Bundle, then it also implies a minimum of one Binary resource, not zero.<br>Under 2:3.65.4.1.2.1 Bundle Resources, may create one or more Binary is specified."
            }]
          },
          "elements": {
            "SpecificationText": [{
              "text": "(Para 5.)<br>The Document Source shall assure all FHIR resource elements are consistent with the Document Sharing metadata requirements as specified for attributes ITI TF-3: <a target='_blank' href=\"https://profiles.ihe.net/ITI/TF/Volume3/ch-4.3.html#4.3.1\">Table 4.3.1-3 \"Sending Actor Metadata Attribute Optionality\"</a>. The Document Source that supports the Comprehensive Metadata or the XDS on FHIR Options shall assure consistency with column \"XDS DS\"; otherwise, the Document Source shall assure consistency with column \"XDR MS\". The Document Source shall not provide any entryUUID values.",
              "comments": "Other DocumentReference Identifiers values will be ignored by Toolkit. Toolkit will assign symbolic Id(s) in the submission to meet XDS requirements."
            }]
          },
          "attributeMap": {
            "SpecificationText": [{
              "text": "(Para 1.)<br/>Refer to ITI TF-3: 4.5.1 for details on the FHIR Resources and how Document Sharing metadata attributes are mapped.",
              "comments": "Relevant information is found in 3:4.5.2 SubmissionSet Metadata Attributes, not in directly in Section 4.5.1."
            }]
          }
        }
      },
      "ITI-65_non-unContainedOption":{
        "common": {
            "Source": {
              "text": "IHE ITI"
            },
            "Profile": {
              "text": "MHDv4",
              "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
            },
            "Transaction": {
              "text": "ITI-65 Provide Document Bundle",
              "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html"
            }
        },
        "context": {
          "sourcePatientInfo": {
            "Volume:Section": {
              "text": "2:3.65.4.1.2.2 Patient Identity",
              "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654122-patient-identity"
            },
            "SpecificationText": [{
              "text": "When the UnContained Reference Option is used, there is no need to populate the sourcePatientInfo element. Otherwise, when sourcePatientInfo is provided, the DocumentReference.context.sourcePatientInfo shall be a reference to a \"contained\" Patient Resource."
            }]
          },
          "MISSINGTEXTInMHD4": {
            "Volume:Section": {
              "text": "1:33.2.3 UnContained Reference Option",
              "link": "https://profiles.ihe.net/ITI/MHD/1332_actor_options.html#13323-uncontained-reference-option"
            },
            "SpecificationText": [{
              "text": "See comments below.",
              "comments": "<span>Specification Missing in MHD 4.x.</span> See Previous MHD PDF Rev. 3.2 ? Trial Implementation. Table 4.5.1.1-1: FHIR DocumentReference mapping to DocumentEntry<br>Note 1: Indicates that the data shall be represented as a contained resource, unless the UnContained References Option is used."
            }]
          }
        }
      },
      "SubmissionSetTypeList": {
        "baseLink": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Minimal.SubmissionSet-definitions.html#List",
        "common": {
          "Source": {
            "text": "IHE ITI"
          },
          "Profile": {
            "text": "MHDv4",
            "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
          },
          "Metadata": {
            "text": "Minimal or Comprehensive"
          }
        },
        "context": {
          ".extension:sourceId": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".date": {
            "Element": {},
            "SpecificationText": [{
              "text": "Control 1..1"
            }]
          },
          ".subject": {
            "Element": {},
            "Metadata": {
              "text": "Minimal"
            },
            "SpecificationText": [{
              "text": "Control 0..1",
              "comments": "MustSupport, Required if known. https://profiles.ihe.net/ITI/MHD/index.html#must-support"
            }]
          },
          "attributeMap": {
            "Volume:Section": {
              "text": "3:4.5.2 SubmissionSet Metadata Attributes",
              "link": "https://profiles.ihe.net/ITI/MHD/32_fhir_maps.html#submissionSet"
            },
            "SpecificationText": [{
              "text": "The documented mapping of the metadata elements associated with a Document Sharing SubmissionSet object attributes."
            }]
          },
          "mappingToXds": {
            "SubmissionSet": {
              "text": "Mappings for XDS and MHD Mapping (XDS)",
              "link": "https://profiles.ihe.net/ITI/MHD/StructureDefinition-IHE.MHD.Minimal.SubmissionSet-mappings.html#mappings-for-xds-and-mhd-mapping-xds"
            },
            "SpecificationText": [{
              "text": "entry<br>&nbsp;&nbsp;item references to DocumentReference(s) and Folder List(s)",
              "comments": "Folder List(s) not yet supported in Toolkit."
            }]
          }
        }
      },
      "patientReference": {
        "Source": {
          "text": "IHE ITI"
        },
        "Profile": {
          "text": "MHDv4",
          "link": "https://profiles.ihe.net/ITI/MHD/toc.html"
        },
        "Transaction": {
          "text": "ITI-65 Provide Document Bundle",
          "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#2-3-65-provide-document-bundle-iti-65"
        },
        "Volume:Section": {
          "text": "2:3.65.4.1.2.2 Patient Identity",
          "link": "https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654122-patient-identity"
        },
        "SpecificationText": [{
          "text": "All DocumentReference.subject, and List.subject values shall be References to a FHIR Patient Resource that may be obtained through use of PDQm, PIXm, or by some other means. If the Patient Resource is accessible to both the Document Source and Document Recipient via an external reference, it shall be included as an external reference. Otherwise, the Patient Resource shall be included in the Bundle."
        }]
      }
    },
    "fhir": {
      "Binary": {
        "baseLink": "https://hl7.org/fhir/binary-definitions.html#Binary",
        "common": {
          "Source": {
            "text": "HL7 FHIR"
          },
          "Resource": {
            "text": "Binary",
            "link": "http://hl7.org/fhir/binary.html"
          }
        },
        "context": {
          ".contentType": {
            "SpecificationText": [{
              "text": "Cardinality 1..1"
            }]
          }
        }
      },
      "Bundle": {
        "baseLink": "https://hl7.org/fhir/bundle-definitions.html#Bundle",
        "common": {
          "Source": {
            "text": "HL7 FHIR",
            "link": "https://hl7.org/fhir/bundle-definitions.html#"
          }
        },
        "context": {
          ".entry.fullUrl": {
            "Section": {
              "text": "2.36.7 Resource Bundle - Detailed Descriptions"
            },
            "Element": {},
            "SpecificationText": [{
              "text": "The Absolute URL for the resource. The fullUrl SHALL NOT disagree with the id in the resource - i.e. if the fullUrl is not a urn:uuid, the URL shall be version-independent URL consistent with the Resource.id. The fullUrl is a version independent reference to the resource.",
              "comments": "See Invariant bdl-8: https://hl7.org/fhir/bundle-definitions.html#Bundle.entry"
            }]
          },
          ".entry.fullUrl-type": {
            "Section": {
              "text": "2.36 Resource Bundle - Content, 2.36.3 Resource Content",
              "link": "https://hl7.org/fhir/bundle-definitions.html#Bundle.entry.fullUrl"
            },
            "SpecificationText": [{
              "text": "Type uri",
              "comments": "Note that since FHIR resources do not need to be served through the FHIR API, the fullURL might be a URN or an absolute URL that does not end with the logical id of the resource (Resource.id)."
            }]
          },
          ".entry.request.method-cardinality": {
            "Section": {
              "text": "2.36.7 Resource Bundle - Detailed Descriptions"
            },
            "Element": {
              "text": "Bundle.entry.request.method",
              "link": "https://hl7.org/fhir/bundle-definitions.html#Bundle.entry.request.method"
            },
            "SpecificationText": [{
              "text": "Cardinality 1..1"
            }]
          },
          ".entry.request.url": {
            "Section": {
              "text": "2.36.7 Resource Bundle - Detailed Descriptions, "
            },
            "Element": {},
            "SpecificationText": [{
              "text": "Type uri<br>Cardinality 1..1",
              "comments": "E.g. for a Patient Create, the method would be \"POST\" and the URL would be \"Patient\". For a Patient Update, the method would be PUT and the URL would be \"Patient/[id]\"."
            }]
          },
          "bundleConstraint-bdl7": {
            "Section": {
              "text": "2.36 Resource Bundle - Content, 2.36.3.2 Constraints",
              "link": "http://hl7.org/fhir/bundle.html#invs"
            },
            "SpecificationText": [{
              "text": "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)"
            }]
          },
          ".total": {
              "Section": {
                "text": "2.36.7 Resource Bundle - Detailed Descriptions"
              },
              "Element": {},
              "SpecificationText": [{
                "text": "If a set of search matches, this is the total number of entries of type 'match' across all pages in the search.",
                "comments": "Only used if the bundle is a search result set. The total does not include resources such as OperationOutcome and included resources, only the total number of matching resources."
              }]
          }
        }
      },
      "restApi": {
        "common": {
           "Source": {
             "text": "HL7 FHIR"
            }
        },
        "context": {
          "transactionProcessingRules-uniqueResource": {
            "Section": {
              "text": "RESTful API 3.1.0.11.2 Transaction Processing Rules",
              "link": "https://hl7.org/fhir/http.html#trules"
            },
            "SpecificationText": [{
              "text": "A resource can only appear in a transaction once (by identity). "
            }]
          },
          "response.lastModified" : {
            "Section": {
              "text": "RESTful API 3.1.0.12 history",
              "link": "https://hl7.org/fhir/http.html#history"
            },
            "SpecificationText": [{
              "text": "Notes:<br>The server SHOULD populate at least response.lastModified so the time of processing is clear in the history record"
            }]
          },
          "transactionResponse-operationOutcome": {
            "Section": {
              "text": "RESTful API 3.1.0.11.3 Batch/Transaction Response",
              "link": "https://hl7.org/fhir/http.html#transaction-response"
            },
            "SpecificationText": [{
              "text": "For a batch, or a successful transaction, the response the server SHALL return a Bundle with type set to batch-response or transaction-response that contains one entry for each entry in the request, in the same order, with the outcome of processing the entry. For a failed transaction, the server returns a single OperationOutcome instead of a Bundle."
            }]
          }
        }
      },
      "httpTransaction": {
        "Source": {
          "text": "HL7 FHIR"
        },
        "Section": {
          "text": "RESTful API 3.1.0.11 batch/transaction",
          "link": "https://hl7.org/fhir/R4/http.html#transaction"
        },
        "SpecificationText": [{
          "text": "(Para 5.)<br>The content of the post submission is a Bundle with Bundle.type = batch or transaction. Each entry SHALL carry request details (Bundle.entry.request) that provides the HTTP details of the action in order to inform the system processing the batch or transaction what to do for the entry. If the HTTP command is a PUT or POST, then the entry SHALL contain a resource for the body of the action. "
        }]
      },
      "resourceUrl-transaction": {
        "Source": {
          "text": "HL7 FHIR"
        },
        "Section": {
          "text": "2.36 Resource Bundle - Content, 2.36.4 Resource URL & Uniqueness rules in a bundle",
          "link": "https://hl7.org/fhir/bundle.html#bundle-unique"
        },
        "SpecificationText": [{
         "text": "For transactions and batches, entries MAY not have fullURLs when the entry.request.method = POST, and the resource has no identity. Note that even in this case, there may still be a fullURL in a transaction on a POST so that relationships between resources can be represented",
          "comments": "When processing a \"POST\" (create), the full URL is treated as the id of the resource on the source, and is ignored; the server generates an id for the resource. (https://hl7.org/fhir/http.html#trules)"
        }]
      }
    },
    "xds": {
      "4.2 ebRIM Representation" : {
        "baseLink": "https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#",
        "common": {
          "Source": {
            "text": "IHE ITI TF"
          },
          "Profile": {
            "text": "XDS",
            "link": "https://profiles.ihe.net/ITI/TF/index.html"
          },
          "Volume:Section": {
            "text": "3:4.2 ebRIM Representation",
            "link": "https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2"
          }
        },
        "context": {
          "associatedPatient": {
            "AssociationType": {
              "text": "4.2.2.1.1 SS-DE HasMember",
              "link": "https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.2.1.1"
            },
            "SpecificationText": [{
              "text": "All DocumentEntries submitted in a SubmissionSet, included by value, shall have their patientId attribute set to the same value. The value of the SubmissionSet.patientId attribute shall match the value of the DocumentEntry.patientId attribute."
            }]
          }
      }
      },
      "4.3.1 Submission Metadata Attribute Optionality" : {
        "Source": {
          "text": "IHE ITI TF"
        },
        "Profile": {
          "text": "XDS",
          "link": "https://profiles.ihe.net/ITI/TF/index.html"
        },
        "Volume:Section": {
          "text": "3:4.3.1 Submission Metadata Attribute Optionality",
          "link": "https://profiles.ihe.net/ITI/TF/Volume3/ch-4.3.html#4.3.1"
        },
        "SpecificationText": [{
          "text": "This section lists which metadata attributes an actor shall provide when initiating a Submission Type Transaction."
        }]
      }
    }
  }
}
