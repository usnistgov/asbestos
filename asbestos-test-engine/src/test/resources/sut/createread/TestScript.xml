<?xml version="1.0" encoding="UTF-8"?>

<TestScript xmlns="http://hl7.org/fhir">
    <name value="createPatient"/>
    <fixture id="example-patient">
        <autocreate value="false"/>
        <autodelete value="false"/>
        <resource>
            <reference value="Patient/patient-example.xml"/>
        </resource>
    </fixture>
    <profile id="patient-profile">
        <reference value="http://hl7.org/fhir/StructureDefinition/Patient"/>
    </profile>
    <variable>
        <name value="V1"/>
        <headerField value="Location"/>
        <sourceId value="R1"/>
    </variable>
    <setup>
        <action>
            <operation>
                <label value="create"/>
                <type>
                    <code value="create"/>
                </type>
                <sourceId value="example-patient"/>
<!--                <url value="http://localhost:9999/fhir/Patient"/>-->
                <responseId value="R1"/>
            </operation>
        </action>
    </setup>
    <test>
        <action>
            <operation>
                <type>
                    <code value="read"/>
                </type>
                <accept value="json"/>
                <responseId value="R2"/>
                <url value="${V1}"/>
            </operation>
        </action>
        <action>
            <assert>
                <resource value="Patient"/>
                <warningOnly value="false"/>
            </assert>
        </action>
        <action>
            <assert>
                <response value="okay"/>
                <warningOnly value="false"/>
            </assert>
        </action>
        <action>
            <assert>
                <validateProfileId value="patient-profile"/>
                <warningOnly value="false"/>
            </assert>
        </action>
    </test>
</TestScript>
